\documentclass{beamer}

\usepackage{graphicx}
\graphicspath{ {./images/} }

\usetheme{Madrid}
%\usetheme{Warsaw}

\newcounter{expl}
\newcommand{\expl}{\refstepcounter{expl} (\theexpl) }

\newcommand{\smalla}{\small}
\newcommand{\smallb}{\footnotesize}
\newcommand{\smallc}{\scriptsize}
\newcommand{\smalld}{\tiny}

\title[Models for the Overlap]{Models for the Overlap}

\author{R. Kuipers}

\begin{document}

%------------------------------------------------------------------------------YEARS------------------------------------------------------------------
\iffalse
%iffalse
\begin{frame}{Years spanning model}
\smalld

\begin{equation}
	\min_{N_{y,m,\sigma}, P_{m,ip}, R_{m,ir,\sigma} \in \mathbb{Z}^*}
	\begin{aligned}
	\frac{1}{|S|} \cdot \sum_{\sigma \in S} ( \sum_{m \in M} [\sum_{y \in Y} 
	(N_{y,m,\sigma} \cdot c_{y,m}) +  
	\sum_{ip \in I^P} (P_{m,ip} \cdot d^P \cdot e^H_m) + \\
	\sum_{ir \in I^R}[\sum_{m' = 0}^{m} (f_{m',ir,\sigma} - R_{m',ir,\sigma})] \cdot e^H_m \cdot H_m ])
	\end{aligned}	
\end{equation}
subject to:
\begin{align}
L_y \cdot N_{y,m,\sigma} + L^{Inst}_{y,m}	&\geq 	\sum_{ip \in I^P} (P_{m,ip} \cdot d^P_y) + \sum_{ir \in I^R} (R_{m,ir,\sigma} \cdot d^R_{y,ir}) +  \epsilon_{\sigma, m, y} 	
																				& \forall \sigma \in S, \forall m \in M, \forall y \in Y 	\\
N_{y,m,\sigma} + N^{Inst}_{y,m}	&\geq 	\rho_{ \sigma, m, y}									& \forall \sigma \in S, \forall m \in M, \forall y \in Y 	\\
\sum_{m' = 0}^{m-1} f_{m',ir,\sigma}	&\geq 	\sum_{m' = 0}^m R_{m',ir,\sigma}							& \forall \sigma \in S, \forall m \in M, \forall ir \in I^R	\\
P_{m,ip} 					&\leq 		\sum_{m' = 0}^{m-G^{MIN}} P_{m',(ip-1)} - \sum_{m' = 0}^{m-1} P_{m',ip}	& \forall m \in M, \forall ip \in I^P 			\\
P_{m,ip} 					&\geq	 	\sum_{m' = 0}^{m-G^{MAX}} P_{m',(ip-1)} - \sum_{m' = 0}^{m-1} P_{m',ip}	& \forall m \in M, \forall ip \in I^P 			\\
N_{y,m,\sigma}				&\leq		A_{y,m} 											& \forall \sigma \in S, \forall m \in M, \forall y \in Y
\end{align}

\end{frame}
\fi

\begin{frame}{Years spanning model}
\smalld

\begin{equation}
	\min_{\substack{N_{y,m,\sigma}, P_{m,ip} \in \mathbb{Z}^* \\ 
	R_{m,ir,\sigma}, F^U_{m,ir,\sigma} \in \mathbb{Z}^* }}
	\begin{aligned}
	\frac{1}{|S|} \cdot \sum_{\sigma \in S} \sum_{m \in M} [ \sum_{y \in Y} 
	(N_{y,m,\sigma} \cdot c_{y,m}) +  
	e^H_m \cdot (\sum_{ip \in I^P} [P_{m,ip} \cdot d^P \cdot e^H_m] + \\
	\sum_{ir \in I^R}[F^U_{m,ir,\sigma} \cdot \frac{H_m}{2} + 
	(F^T_{m,ir,\sigma} - F^U_{m,ir,\sigma}) \cdot (d^R_{ir} + d^D_{ir}) + 
	R_{m,ir,\sigma}  \cdot d^R_{ir}])]
	\end{aligned}	
\end{equation}
subject to:
\begin{align}
\begin{aligned} \sum_{ir\in I^R} d^R_{y, ir} \cdot (F^T_{m,ir,\sigma} + F^U_{m-1,ir,\sigma} - \\ 
F^U_{m,ir,\sigma} - R_{m,ir,\sigma}) \end{aligned}	
						&\leq		\begin{aligned} L_y \cdot N_{y,m,\sigma} + L^{Inst}_{y,m} - \sum_{ip \in I^P} (P_{m,ip} \cdot d^P_y) - \\ 
					\sum_{ir \in I^R} (R_{m,ir,\sigma} \cdot d^R_{y,ir}) -  \epsilon_{\sigma, m, y} \end{aligned}		& \forall \sigma \in S, \forall m \in M, \forall y \in Y	\\
\rho_{ \sigma, m, y} - N^{Inst}_{y,m}	&\leq		 N_{y,m,\sigma}	\leq 	A_{y,m} 							& \forall \sigma \in S, \forall m \in M, \forall y \in Y 	\\
R_{m+1,ir,\sigma}				&\leq		F^U_{m,ir,\sigma}	\leq	F^T_{m, ir, \sigma}						& \forall \sigma \in S, \forall m \in M, \forall ir \in I^R	\\
\sum_{m' = 0}^{m-G^U} P_{m',(ip-1)} - \sum_{m' = 0}^{m-1} P_{m',ip} 	&\leq P_{m,ip}	\leq 	\sum_{m' = 0}^{m-G^L} P_{m',(ip-1)} - \sum_{m' = 0}^{m-1} P_{m',ip}	
																				& \forall m \in M, \forall ip \in I^P			
\end{align}

\end{frame}

\begin{frame}{Years model Explanation}
\smalla
\expl The objective takes an average cost of all scenarios by counting up the cost per month. Each month has a cost for vessels chartered (by type), the energy lost due to planned maintenance, and the cost of failures (broken up in missed energy from unrepaired failures, repaired failures, and planned repair tasks that fix older failures) \\
\expl For each vessel type the available time (based on charters and spare time from installation) minus the planned time the vessels are used (for planned maintenance and repairs) needs to be greater than the time spend fixing new failures. This LHS will never be negative, which enforces enough vessels are chartered to at least deal with all planned tasks. \\
\expl Ensures enough vessels are assigned to a given month (based on feedback from that month), and the amount of vessels chartered doesn't surpass the available vessels \\
\expl For any type of reactive task, the amount of tasks performed cannot exceed the amount of unhandled failures of that type from the previous month \\
\expl Ensures planned tasks are not scheduled too close together or too far apart by counting up the turbines that were last visited $G^U$ and $G^L$ or more months ago respectively, and subtracting all that were revisited more recently
\end{frame}

\begin{frame}{Years model notation overview}
\smalld
\begin{columns}
\begin{column}{.48\textwidth}
Sets:
\begin{itemize}
\item $S$: Scenarios
\item $M$: Months
\item $Y$: Vessel types
\item $I^P$: Indices for the planned tasks (first time a turbine is visited is index 1, second time is index 2, etc...)
\item $I^R$: Types of failures and reactive tasks
\end{itemize}

Decision variables:
\begin{itemize}
\item $N_{y,m,\sigma}$: The amount of vessels of type $y$ chartered in month $m$ in scenario $\sigma$
\item $P_{m,ip}$: Planned tasks in iteration $ip \in I^P$ in month $m$
\item $R_{m,ir,\sigma}$: Reactive tasks of type $ir \in I^R$ in month $m$ and scenario $\sigma$
\item $F^U_{m,ir,\sigma}$: Unhandled failures of type $ir \in I^R$ in month $m$ and scenario $\sigma$
\end{itemize}

Parameters:
\begin{itemize}
\item $c_{y,m}$: The cost of chartering a vessel of type $y$ in month $m$
\item $e^H_m$: The energy produced by a single turbine per hour in month $m$
\item $F^T_{m,ir,\sigma}$: The total amount of failures of type $ir \in I^R$ in month $m$ in scenario $\sigma$
\item $H_m$: The number of hours in month $m$
\end{itemize}
\end{column}

\hfill

\begin{column}{.48\textwidth}
Parameters (cont):
\begin{itemize}
\item $\epsilon_{\sigma, m, y}$: Feedback parameter that enforces leighway in the amount of vessel time available to month $m$
\item $\rho_{ \sigma, m, y}$: Feedback parameter that enforces a minimum amount of a certain vessel assigned to month $m$
\item $L_y$: The amount of hours a vessel of type $y$ is available if chartered for a month
\item $L^{Inst}_{y,m}$: Leftover hours vessels of type $y$ are available in month $m$ based on the installation schedule
\item $N^{Inst}_{y,m}$: Amount of vessels of type $y$ used by the installation schedule in month $m$ that can also partially help out with maintenance operations
\item $d^P$: The duration that a preventive task will take a turbine offline
\item $d^P_y$: The duration of a preventive task for vessel type $y$
\item $d^R_{ir}$: The duration that reactive task $ir$ will take a turbine offline
\item $d^D_{ir}$: The delay before a failure of type $ir$ is detected and can be worked on
\item $d^R_{y,ir}$: The duration of a reactive task $ir$ for vessel type $y$
\item $G^U$ \& $G^L$: The Upper and Lower bounds months between two planned maintenance tasks
\item $A_{y,m}$: The number of maximum available vessels of type $y$ in month $m$
\end{itemize}
\end{column}
\end{columns}
\end{frame}

%-----------------------------------------------------------------------------MONTHS------------------------------------------------------------------

\begin{frame}{Months spanning model}
\smallc

\begin{equation}
	\min_{\substack{s_i \in \mathbb{R}_{\geq 0} \\ 
	a^F_{v,i}, a^L_{v,i}, a_{v,i,i'} \in \{0, 1\}}} 
	\sum_{i \in I} c_i \cdot (s_i + \max_{y \in Y} (s_{y,i}+ d_{y,i}))
\end{equation}
subject to:
\begin{align}
\sum_{i \in I} a^F_{v,i}							&\leq	1							&\forall v \in V						\\
a^F_{v,i} + \sum_{i' \in I - \{i\}} a_{v,i',i}				&=	a^L_{v,i} + \sum_{i' \in I - \{i\}} a_{v,i,i'}	&\forall v \in V, \forall i \in I				\\	
\sum_{v \in V_y} (a^F_{v,i} +  \sum_{i' \in I - \{i\}} a_{v,i',i})	&\geq	\rho_{y,i}  						& \forall y \in Y, \forall i \in I^{Maint} 			\\
s_{i'} + s_{y,i'} - s_i - s_{i,y}						&\geq	(M + d_{y,i}) \cdot a_{v,i,i'} - M	 		& \begin{aligned} \forall y \in Y, \forall v \in V_y, 	\\
																		\forall i, i' \in I | i \neq i'		\end{aligned}	\\
r_i 								\leq	 s_i	&\leq	T - \max_{y \in Y} (s_{y,i}+ d_{y,i})		&\forall i \in I^{Maint}					\\
a^F_{v,i} +  \sum_{i' \in I - \{i\}} a_{v,i',i}				&=	a^{Inst}_{v,i}					& \forall v \in V, \forall i \in I^{Inst}  			\\
s_i										&=	s^{Inst}_i 						& \forall I \in I^{Inst} 
\end{align}

\end{frame}

\begin{frame}{Months model Explanation}
\expl Objective is to minimise costs of tasks being uncompleted (the +max bit is optional as it's about constants) \\ 
\expl Ensures every vessel has at most one first task \\ 
\expl Ensures that a vessel follows a path without brances \\
\expl Ensures every task has enough resourses assigned to it \\
\expl Ensures the starting times of consecutive tasks are separated by at least the duration of the first task \\
\expl Ensures all tasks are started after their release time, and finished on time \\
\expl Forces every installation task to be assigned as in the installation schedule \\
\expl Forces every installation task to be started as in the installation schedule
\end{frame}

\begin{frame}{Months model notation overview}
\smallc
\begin{columns}
\begin{column}{.48\textwidth}
Sets:
\begin{itemize}
\item $Y$: Vessel types
\item $V$: Individual vessels
\item $V_y \subseteq V$: Vessels of type $y \in Y$ 
\item $I^{Inst}$:  Installation tasks completed this month by vessels that are also available for maintenance tasks
\item $I^{Maint}$: Maintenance tasks to be scheduled this month
\item $I = I^{Inst} \cup I^{Maint}$:  Tasks to be completed in this month
\end{itemize}

Decision variables:
\begin{itemize}
\item $s_i$: Start time of task $i$
\item $a^F_{v,i}$ \& $a^L_{v,i}$: Binary variables, 1 for the first and last task $i$ of vessel $v$ respectively
\item $a_{v,i,i'}$: Binary variable which is 1 if vessel $v$ performs task $i'$ after task $i'$
\end{itemize}
\end{column}

\hfill

\begin{column}{.48\textwidth}
Parameters:
\begin{itemize}
\item $c_i$: The cost per hour of a task not being completed
\item $s_{y,i}$: The start time offset between task $i$ starting and vessel type $y$ being used for it
\item $d_{y,i}$: The duration of task $i$ for vessel type $y$
\item $\rho_{y,i}$: The amount of vessels of type $y$ required for task $i$
\item $M$: A large number
\item $r_i$: The release time of task $i$; it cannot be started before this time
\item $T$: The end time of the month
\item $s^{Inst}_i$: Start time of task $i \in I^{Inst}$, as in the installation schedule
\item $a^{Inst}_{v,i}$: Binary assignment variable of task $i \in I^{Inst}$, as in the installation schedule
\end{itemize}
\end{column}
\end{columns}
\end{frame}

\end{document}


